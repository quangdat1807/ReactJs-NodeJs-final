{"ast":null,"code":"var _s = $RefreshSig$();\n\n/* eslint-disable react-hooks/exhaustive-deps */\nimport axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { PATHS } from \"../../constants/paths\";\nimport { location } from \"../../../locations/cities.json\";\nconst FETCH_TYPES = {\n  CITIES: \"FETCH_CITIES\",\n  DISTRICTS: \"FETCH_DISTRICTS\",\n  WARDS: \"FETCH_WARDS\"\n};\n\nasync function fetchLocationOptions(fetchType, locationId) {\n  let url;\n\n  switch (fetchType) {\n    case FETCH_TYPES.CITIES:\n      {\n        url = location;\n        break;\n      }\n\n    case FETCH_TYPES.DISTRICTS:\n      {\n        url = `${PATHS.DISTRICTS}/${locationId}.json`;\n        break;\n      }\n\n    case FETCH_TYPES.WARDS:\n      {\n        url = `${PATHS.WARDS}/${locationId}.json`;\n        break;\n      }\n\n    default:\n      {\n        return [];\n      }\n  }\n\n  const locations = (await axios.get(url)).data[\"data\"];\n  return locations.map(_ref => {\n    let {\n      id,\n      name\n    } = _ref;\n    return {\n      value: id,\n      label: name\n    };\n  });\n}\n\nasync function fetchInitialData() {\n  const {\n    cityId,\n    districtId,\n    wardId\n  } = (await axios.get(PATHS.LOCATION)).data;\n  const [cities, districts, wards] = await Promise.all([fetchLocationOptions(FETCH_TYPES.CITIES), fetchLocationOptions(FETCH_TYPES.DISTRICTS, cityId), fetchLocationOptions(FETCH_TYPES.WARDS, districtId)]);\n  return {\n    cityOptions: cities,\n    districtOptions: districts,\n    wardOptions: wards,\n    selectedCity: cities.find(c => c.value === cityId),\n    selectedDistrict: districts.find(d => d.value === districtId),\n    selectedWard: wards.find(w => w.value === wardId)\n  };\n}\n\nfunction useLocationForm(shouldFetchInitialLocation) {\n  _s();\n\n  const [state, setState] = useState({\n    cityOptions: [],\n    districtOptions: [],\n    wardOptions: [],\n    selectedCity: null,\n    selectedDistrict: null,\n    selectedWard: null\n  });\n  const {\n    selectedCity,\n    selectedDistrict\n  } = state;\n  useEffect(() => {\n    (async function () {\n      if (shouldFetchInitialLocation) {\n        const initialData = await fetchInitialData();\n        setState(initialData);\n      } else {\n        const options = await fetchLocationOptions(FETCH_TYPES.CITIES);\n        setState({ ...state,\n          cityOptions: options\n        });\n      }\n    })();\n  }, []);\n  useEffect(() => {\n    (async function () {\n      if (!selectedCity) return;\n      const options = await fetchLocationOptions(FETCH_TYPES.DISTRICTS, selectedCity.value);\n      setState({ ...state,\n        districtOptions: options\n      });\n    })();\n  }, [selectedCity]);\n  useEffect(() => {\n    (async function () {\n      if (!selectedDistrict) return;\n      const options = await fetchLocationOptions(FETCH_TYPES.WARDS, selectedDistrict.value);\n      setState({ ...state,\n        wardOptions: options\n      });\n    })();\n  }, [selectedDistrict]);\n\n  function onCitySelect(option) {\n    setState({ ...state,\n      districtOptions: [],\n      wardOptions: [],\n      selectedCity: option,\n      selectedDistrict: null,\n      selectedWard: null\n    });\n  }\n\n  function onDistrictSelect(option) {\n    setState({ ...state,\n      wardOptions: [],\n      selectedDistrict: option,\n      selectedWard: null\n    });\n  }\n\n  function onWardSelect(option) {\n    setState({ ...state,\n      selectedWard: option\n    });\n  }\n\n  function onSubmit(data) {//     console.log(data)\n    //     var config = {\n    //         method: \"post\",\n    //         url: \"http://localhost:8080/checkout\",\n    //         data: data\n    //     };\n    //     axios(config)\n    //         .then(function (response) {\n    //             console.log(response);\n    //             // window.location.assign('http://localhost:3000/admin/products/1');\n    //             if (response.data == \"Thành Công\") {\n    //             }\n    //         })\n    //         .catch(function (error) {\n    //             console.log(error);\n    //         });\n    //     // window.location.reload();\n  }\n\n  return {\n    state,\n    onCitySelect,\n    onDistrictSelect,\n    onWardSelect,\n    onSubmit\n  };\n}\n\n_s(useLocationForm, \"9B/4iHrd4N4v+nkX+CGYxqFRV+g=\");\n\nexport default useLocationForm;","map":{"version":3,"names":["axios","useEffect","useState","PATHS","location","FETCH_TYPES","CITIES","DISTRICTS","WARDS","fetchLocationOptions","fetchType","locationId","url","locations","get","data","map","id","name","value","label","fetchInitialData","cityId","districtId","wardId","LOCATION","cities","districts","wards","Promise","all","cityOptions","districtOptions","wardOptions","selectedCity","find","c","selectedDistrict","d","selectedWard","w","useLocationForm","shouldFetchInitialLocation","state","setState","initialData","options","onCitySelect","option","onDistrictSelect","onWardSelect","onSubmit"],"sources":["D:/TMA-React/demoTest/Demo/client/src/components/checkout/useLocationForm.js"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\r\nimport axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { PATHS } from \"../../constants/paths\";\r\nimport { location} from \"../../../locations/cities.json\"\r\n\r\nconst FETCH_TYPES = {\r\n    CITIES: \"FETCH_CITIES\",\r\n    DISTRICTS: \"FETCH_DISTRICTS\",\r\n    WARDS: \"FETCH_WARDS\",\r\n};\r\n\r\nasync function fetchLocationOptions(fetchType, locationId) {\r\n    let url;\r\n    switch (fetchType) {\r\n        case FETCH_TYPES.CITIES: {\r\n            url = location;\r\n            break;\r\n        }\r\n        case FETCH_TYPES.DISTRICTS: {\r\n            url = `${PATHS.DISTRICTS}/${locationId}.json`;\r\n            break;\r\n        }\r\n        case FETCH_TYPES.WARDS: {\r\n            url = `${PATHS.WARDS}/${locationId}.json`;\r\n            break;\r\n        }\r\n        default: {\r\n            return [];\r\n        }\r\n    }\r\n    const locations = (await axios.get(url)).data[\"data\"];\r\n    return locations.map(({ id, name }) => ({ value: id, label: name }));\r\n}\r\n\r\nasync function fetchInitialData() {\r\n    const { cityId, districtId, wardId } = (await axios.get(PATHS.LOCATION)).data;\r\n    const [cities, districts, wards] = await Promise.all([\r\n        fetchLocationOptions(FETCH_TYPES.CITIES),\r\n        fetchLocationOptions(FETCH_TYPES.DISTRICTS, cityId),\r\n        fetchLocationOptions(FETCH_TYPES.WARDS, districtId),\r\n    ]);\r\n    return {\r\n        cityOptions: cities,\r\n        districtOptions: districts,\r\n        wardOptions: wards,\r\n        selectedCity: cities.find((c) => c.value === cityId),\r\n        selectedDistrict: districts.find((d) => d.value === districtId),\r\n        selectedWard: wards.find((w) => w.value === wardId),\r\n    };\r\n}\r\n\r\nfunction useLocationForm(shouldFetchInitialLocation) {\r\n    const [state, setState] = useState({\r\n        cityOptions: [],\r\n        districtOptions: [],\r\n        wardOptions: [],\r\n        selectedCity: null,\r\n        selectedDistrict: null,\r\n        selectedWard: null,\r\n    });\r\n\r\n    const { selectedCity, selectedDistrict } = state;\r\n\r\n    useEffect(() => {\r\n        (async function () {\r\n            if (shouldFetchInitialLocation) {\r\n                const initialData = await fetchInitialData();\r\n                setState(initialData);\r\n            } else {\r\n                const options = await fetchLocationOptions(FETCH_TYPES.CITIES)\r\n                setState({ ...state, cityOptions: options })\r\n            }\r\n        })();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        (async function () {\r\n            if (!selectedCity) return;\r\n            const options = await fetchLocationOptions(FETCH_TYPES.DISTRICTS, selectedCity.value);\r\n            setState({ ...state, districtOptions: options })\r\n        })();\r\n    }, [selectedCity]);\r\n\r\n    useEffect(() => {\r\n        (async function () {\r\n            if (!selectedDistrict) return;\r\n            const options = await fetchLocationOptions(FETCH_TYPES.WARDS, selectedDistrict.value);\r\n            setState({ ...state, wardOptions: options })\r\n        })()\r\n    }, [selectedDistrict])\r\n\r\n    function onCitySelect(option) {\r\n        setState({\r\n            ...state,\r\n            districtOptions: [],\r\n            wardOptions: [],\r\n            selectedCity: option,\r\n            selectedDistrict: null,\r\n            selectedWard: null,\r\n        });\r\n    }\r\n\r\n    function onDistrictSelect(option) {\r\n        setState({\r\n            ...state,\r\n            wardOptions: [],\r\n            selectedDistrict: option,\r\n            selectedWard: null,\r\n        });\r\n    }\r\n\r\n    function onWardSelect(option) {\r\n        setState({ ...state, selectedWard: option });\r\n    }\r\n\r\n    function onSubmit(data) {\r\n    //     console.log(data)\r\n    //     var config = {\r\n    //         method: \"post\",\r\n    //         url: \"http://localhost:8080/checkout\",\r\n    //         data: data\r\n    //     };\r\n    //     axios(config)\r\n    //         .then(function (response) {\r\n    //             console.log(response);\r\n                \r\n    //             // window.location.assign('http://localhost:3000/admin/products/1');\r\n    //             if (response.data == \"Thành Công\") {\r\n                    \r\n    //             }\r\n\r\n\r\n    //         })\r\n    //         .catch(function (error) {\r\n    //             console.log(error);\r\n    //         });\r\n    //     // window.location.reload();\r\n    }\r\n\r\n    return { state, onCitySelect, onDistrictSelect, onWardSelect, onSubmit };\r\n}\r\n\r\nexport default useLocationForm;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}